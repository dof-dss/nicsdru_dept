# D7 SQL: select d.domain_id, d.machine_name, count(da.nid) as nodes from domain d join domain_access da on d.domain_id = da.gid join node n on n.nid = da.nid where n.type = 'news' group by d.domain_id, d.machine_name order by nodes desc;
langcode: en
status: true
dependencies: {  }
id: group_node_news
migration_tags:
  - dept_sites
migration_group: migrate_group_nodes
label: 'Drupal 7 news nodes to Group content'
source:
  plugin: d7_node_domain
  node_type: news
  ids:
    uuid:
      type: string
      max_length: 1024
process:
  type:
    plugin: default_value
    default_value: department_site-group_node-news
  gid:
    -
      plugin: skip_on_empty
      method: row
      source: domain_node/0/target_id
    -
      plugin: skip_on_value
      method: row
      source: domain_node/0/target_id
      value:
        - 'daera'
        - 'del'
        - 'economy'
        - 'execoffice'
        - 'education'
        - 'health'
        - 'infrastructure'
        - 'dcal'
        - 'doe'
        - 'justice'
        - 'communities'
    -
      plugin: static_map
      bypass: false
      source: domain_node/0/target_id
      map:
        'newnigov': 1
        'dfp': 2
      default_value: 1
  label: title
  entity_id:
    -
      plugin: migration_lookup
      migration: node_news
      source: uuid
  uid: uid
  created: created
destination:
  plugin: 'entity:group_content'
migration_dependencies:
  required:
    - d7_user
    - node_news
